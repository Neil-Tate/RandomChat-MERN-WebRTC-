(this["webpackJsonpyour-app"]=this["webpackJsonpyour-app"]||[]).push([[0],{420:function(e,t,a){e.exports=a(882)},428:function(e,t,a){},450:function(e,t,a){},451:function(e,t,a){},452:function(e,t,a){},467:function(e,t,a){},470:function(e,t,a){},708:function(e,t,a){},711:function(e,t,a){},712:function(e,t,a){},767:function(e,t,a){},823:function(e,t){},863:function(e,t){},865:function(e,t){},879:function(e,t,a){},880:function(e,t,a){},881:function(e,t,a){},882:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),s=a(20),o=a.n(s),r=(a(425),a(426),a(427),a(428),a(11)),l=a(12),c=a(17),h=a(16),u=a(75),d=a(266),m=a(89);function g(e){if(!e)return null;try{var t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(a){return null}}function p(e,t){e||console.error("Error: Key is missing");try{localStorage.setItem(e,JSON.stringify(t))}catch(a){console.error(a)}}var f=a(9),v=a(4),b=(a(450),function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={collapse:!1,isWideEnough:!1},n.onClick=n.onClick.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"onClick",value:function(){this.setState({collapse:!this.state.collapse})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("header",null,i.a.createElement(u.a,null,i.a.createElement(v.w,{color:"bg-primary",fixed:"top",dark:!0,expand:"md",scrolling:!0,transparent:!0},i.a.createElement(v.i,{size:"md"},i.a.createElement(v.x,{href:"/"},i.a.createElement("strong",{className:"navbar-title"},"Chat With Stranger")),!this.state.isWideEnough&&i.a.createElement(v.z,{onClick:this.onClick}),i.a.createElement(v.h,{isOpen:this.state.collapse,navbar:!0},i.a.createElement(v.y,{right:!0},i.a.createElement(v.u,null,i.a.createElement(v.v,{to:"/guest"},"GUEST")),i.a.createElement(v.u,null,i.a.createElement(v.v,{to:"/login"},"SIGN IN")),i.a.createElement(v.u,null,i.a.createElement(v.v,{to:"/register"},"SIGN UP"))))))),i.a.createElement(v.E,{src:"/background.jpg"},i.a.createElement(v.s,{overlay:"purple-light",className:"flex-center flex-column text-white text-center"},i.a.createElement("strong",null,i.a.createElement("h2",null,"Random Video, Text & Audio Chat with Strangers")),i.a.createElement("br",null),i.a.createElement("h5",null,"It provides free random chat with cool people in private chat rooms."),i.a.createElement("p",null,"Chat with strangers & send pictures, videos in private free chat rooms. Meet & talk to strangers from all over the world."),i.a.createElement("br",null),i.a.createElement("div",{className:"btn-group"},i.a.createElement(v.v,{to:"/guest"},i.a.createElement(v.b,{color:"secondary",size:"lg"},i.a.createElement(v.n,{icon:"user-shield",className:"mr-1",size:"lg"})," Chat as a guest")),i.a.createElement(v.v,{to:"/usersign"},i.a.createElement(v.b,{color:"primary",size:"lg"},i.a.createElement(v.n,{icon:"user",className:"mr-1",size:"lg"})," Login as a user")))))),i.a.createElement("main",null,i.a.createElement(v.i,{className:"text-center my-5"},i.a.createElement("p",{align:"justify"},"Texting strangers might come naturally to some but others may have goose bumps when they are trying to text strangers. When you text strangers you are opening a window into a great text chat with strangers. The first few texts are the most difficult ones, once you have started texting and managed to move past opening texts the rest is easy peasy lemon squeezy. Sending a text to strangers is just like letter writing which was back then known as making pen pals. However, these days text to strangers chat room is a modern way of connecting with strangers. When you text strangers you are at the first step of a great conversation that could blossom into a good friendship or even a relationship. There are many examples in the world where people have found their soulmates when they were random texting strangers online. Many people online text with strangers in order to find some company and to talk to someone. When you send a text to strangers what happens next is a total mystery. It might end abruptly a couple of times whereas other times it might turn into a beautiful conversation and a pleasant experience."))))}}]),a}(i.a.Component)),E=(a(451),a(893)),S=a(894),y=a(895),k=a(892),C=a(897),w=a(898),j=(a(452),a(899)),O=a(890),N=a(896),I=a(891),M=(a(188),"https://anonymous-video-chat.herokuapp.com"),U=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e,n){var i;return Object(r.a)(this,a),(i=t.call(this,e,n)).handleChange=i.handleChange.bind(Object(f.a)(i)),i.handleChangeEmail=i.handleChangeEmail.bind(Object(f.a)(i)),i.handleChangeConfirm=i.handleChangeConfirm.bind(Object(f.a)(i)),i.handleChangeName=i.handleChangeName.bind(Object(f.a)(i)),i.handleDismiss=i.handleDismiss.bind(Object(f.a)(i)),i.handleShow=i.handleShow.bind(Object(f.a)(i)),i.signUpClicked=i.signUpClicked.bind(Object(f.a)(i)),i.displayAlert=i.displayAlert.bind(Object(f.a)(i)),i.state={password:"",email:"",confPass:"",name:"",signInLoading:!1,show:!1,signupStatus:"success",signUpMessage:"You have signed up successfully. Proceed to login."},i}return Object(l.a)(a,[{key:"validateEmail",value:function(){if(0===this.state.email.length)return null;return/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(String(this.state.email).toLowerCase())?"success":"error"}},{key:"getValidationState",value:function(){var e=this.state.password.length;return e>8?"success":e>5?"warning":e>0?"error":null}},{key:"getValidationStateConf",value:function(){return 0===this.state.confPass.length?null:this.state.password===this.state.confPass?"success":"error"}},{key:"handleChange",value:function(e){this.setState({password:e.target.value})}},{key:"handleChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"handleChangeConfirm",value:function(e){this.setState({confPass:e.target.value})}},{key:"handleChangeName",value:function(e){this.setState({name:e.target.value})}},{key:"handleDismiss",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"displayAlert",value:function(){return i.a.createElement(j.a,{bsStyle:this.state.signupStatus,onDismiss:this.handleDismiss,id:"alertBox"},i.a.createElement("p",null,this.state.signUpMessage))}},{key:"signUpClicked",value:function(e){var t=this;this.setState({signInLoading:!0});var a={password:this.state.password,name:this.state.name,email:this.state.email};fetch(M+"/api/account/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){console.log("json",e),"Signed Up"===e.message?t.setState({signInLoading:!1,show:!0,signupStatus:"success",signUpMessage:"You have signed up successfully. Proceed to login.",name:"",password:"",confPass:"",email:""}):"Error: Account Already Exists"===e.message?t.setState({signInLoading:!1,show:!0,signupStatus:"warning",signUpMessage:"Account already Exists. Procced to login",name:"",password:"",confPass:"",email:""}):"Error: Server Error"===e.message&&t.setState({signInLoading:!1,show:!0,signupStatus:"danger",signUpMessage:"Unexpected error. Please try again later.",name:"",password:"",confPass:"",email:""})}))}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("form",null,i.a.createElement(O.a,{controlId:"signUpName"},i.a.createElement(N.a,{type:"text",value:this.state.name,placeholder:"Name",onChange:this.handleChangeName})),i.a.createElement(O.a,{controlId:"signUpEmail",validationState:this.validateEmail()},i.a.createElement(N.a,{type:"email",value:this.state.email,placeholder:"Email",onChange:this.handleChangeEmail}),i.a.createElement(N.a.Feedback,null)),i.a.createElement(O.a,{controlId:"formBasicTextSignupPass",validationState:this.getValidationState()},i.a.createElement(N.a,{type:"password",value:this.state.password,placeholder:"Password",onChange:this.handleChange}),i.a.createElement(N.a.Feedback,null),i.a.createElement(I.a,{id:"passwordHelp"},"Password must be minimum 8 characters long")),i.a.createElement(O.a,{controlId:"formBasicTextSignupConfPass",validationState:this.getValidationStateConf()},i.a.createElement(N.a,{type:"password",value:this.state.confPass,placeholder:"Confirm Password",onChange:this.handleChangeConfirm}),i.a.createElement(N.a.Feedback,null)),i.a.createElement(k.a,{block:!0,bsStyle:"warning",disabled:this.state.signInLoading,onClick:this.state.signInLoading?null:this.signUpClicked},this.state.signInLoading?"Processing...":"Sign Up")),this.state.show?this.displayAlert():null)}}]),a}(n.Component),x=(a(467),function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e,n){var i;return Object(r.a)(this,a),(i=t.call(this,e,n)).handleChange=i.handleChange.bind(Object(f.a)(i)),i.handleChangeEmail=i.handleChangeEmail.bind(Object(f.a)(i)),i.logInClicked=i.logInClicked.bind(Object(f.a)(i)),i.handleDismiss=i.handleDismiss.bind(Object(f.a)(i)),i.handleShow=i.handleShow.bind(Object(f.a)(i)),i.displayAlert=i.displayAlert.bind(Object(f.a)(i)),i.state={password:"",email:"",logInLoading:!1,signInError:"",show:!1,logInStatus:"danger"},i}return Object(l.a)(a,[{key:"validateEmail",value:function(){if(0===this.state.email.length)return null;return/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(String(this.state.email).toLowerCase())?"success":"error"}},{key:"getValidationState",value:function(){var e=this.state.password.length;return e>8?"success":e>5?"warning":e>0?"error":null}},{key:"handleChange",value:function(e){this.setState({password:e.target.value})}},{key:"handleChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"logInClicked",value:function(){var e=this,t=this.state,a=t.email,n=t.password;this.setState({logInLoading:!0}),fetch(M+"/api/account/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,password:n})}).then((function(e){return e.json()})).then((function(t){console.log("json",t),t.success?(p("the_login_n_signup",{token:t.token,name:t.name}),e.setState({signInError:"Welcome "+t.name+"!",logInLoading:!1,password:"",email:"",token:t.token,show:!0,logInStatus:"success"}),e.props.stateChanger({loggedIn:!0,token:t.token,loggedInName:t.name,logOutButtonStatus:"warning"})):e.setState({signInError:t.message,logInLoading:!1,show:!0,logInStatus:"danger"})}))}},{key:"handleDismiss",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"displayAlert",value:function(){return i.a.createElement(j.a,{bsStyle:this.state.logInStatus,onDismiss:this.handleDismiss,id:"alertBox"},i.a.createElement("p",null,this.state.signInError))}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("form",null,i.a.createElement(O.a,{controlId:"LogInEmail",validationState:this.validateEmail()},i.a.createElement(N.a,{type:"email",value:this.state.email,placeholder:"Email",onChange:this.handleChangeEmail}),i.a.createElement(N.a.Feedback,null)),i.a.createElement(O.a,{controlId:"formBasicText",validationState:this.getValidationState()},i.a.createElement(N.a,{type:"password",value:this.state.password,placeholder:"Password",onChange:this.handleChange}),i.a.createElement(N.a.Feedback,null))),i.a.createElement(k.a,{block:!0,bsStyle:"success",disabled:this.state.logInLoading,onClick:this.state.logInLoading?null:this.logInClicked},this.state.logInLoading?"Authenticating...":"Log In"),this.state.show?this.displayAlert():null)}}]),a}(n.Component)),L=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e,n){var i;return Object(r.a)(this,a),(i=t.call(this,e,n)).stateChanger=i.stateChanger.bind(Object(f.a)(i)),i.logOutClicked=i.logOutClicked.bind(Object(f.a)(i)),i.state={loggedIn:!1,token:"",loggedInName:"Unnamed Ashok Kumar",logOutButtonStatus:"warning",logOutLoadingMessage:"Log Out",logOutLoading:!1},i}return Object(l.a)(a,[{key:"stateChanger",value:function(e){this.setState(e)}},{key:"componentDidMount",value:function(){var e=this,t=g("the_login_n_signup");if(t&&t.token){var a=t.token,n=t.name;fetch(M+"/api/account/verify?token="+a).then((function(e){return e.json()})).then((function(t){t.success?e.setState({token:a,loggedInName:n,logOutLoading:!1,loggedIn:!0}):e.setState({logOutLoading:!1})}))}else this.setState({logOutLoading:!1})}},{key:"logOutClicked",value:function(){var e=this;this.setState({logOutLoading:!0,logOutLoadingMessage:"Logging Out...",logOutButtonStatus:"info"});var t=g("the_login_n_signup");if(t&&t.token){var a=t.token;fetch(M+"/api/account/logout?token="+a).then((function(e){return e.json()})).then((function(t){t.success?e.setState({token:"",logOutLoading:!1,loggedIn:!1}):e.setState({logOutLoading:!1})}))}else this.setState({logOutLoading:!1})}},{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement("header",{className:"App-header"},i.a.createElement("h1",{className:"App-title"},"Login Or Sign-Up")),i.a.createElement(E.a,null,i.a.createElement(S.a,null,i.a.createElement(y.a,{md:4}),i.a.createElement(y.a,{xs:12,md:4},this.state.loggedIn?i.a.createElement("div",null,i.a.createElement("h1",null,"Welcome ",this.state.loggedInName,"!"),i.a.createElement(k.a,{block:!0,bsStyle:this.state.logOutButtonStatus,disabled:this.state.logOutLoading,onClick:this.state.logOutLoading?null:this.logOutClicked},this.state.logOutButtonStatus?"Log Out":"Logging Out")):i.a.createElement("div",{className:"loginBoxContainer"},i.a.createElement(C.a,{defaultActiveKey:1,id:"uncontrolled-tab-example"},i.a.createElement(w.a,{eventKey:1,title:"Login",className:"tabContent"},i.a.createElement(x,{stateChanger:this.stateChanger})),i.a.createElement(w.a,{eventKey:2,title:"Sign Up",className:"tabContent"},i.a.createElement(U,null))))),i.a.createElement(y.a,{md:4}))))}}]),a}(n.Component),T=["Afghanistan","Albania","Algeria","Andorra","Angola","Antigua and Barbuda","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cabo Verde","Cambodia","Cameroon","Canada","Central African Republic (CAR)","Chad","Chile","China","Colombia","Comoros","Costa Rica","Cote d'Ivoire","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Fiji","Finland","France","Gabon","Gambia","Georgia","Germany","Ghana","Greece","Grenada","Guatemala","Guinea","Guinea-Bissau","Guyana","Haiti","Honduras","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kosovo","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macedonia (FYROM)","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Mauritania","Mauritius","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Morocco","Mozambique","Myanmar (Burma)","Namibia","Nauru","Nepal","Netherlands","New Zealand","Nicaragua","Niger","Nigeria","North Korea","Norway","Oman","Pakistan","Palau","Palestine","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Poland","Portugal","Qatar","Romania","Russia","Rwanda","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Swaziland","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste","Togo","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Tuvalu","Uganda","Ukraine","United Arab Emirates (UAE)","United Kingdom (UK)","United States of America (USA)","Uruguay","Uzbekistan","Vanuatu","Vatican City (Holy See)","Venezuela","Vietnam","Yemen","Zambia","Zimbabwe"],A=(a(470),function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e,n){var i;return Object(r.a)(this,a),(i=t.call(this,e,n)).handleChangeName=i.handleChangeName.bind(Object(f.a)(i)),i.handleChangeLocation=i.handleChangeLocation.bind(Object(f.a)(i)),i.handleChangeAge=i.handleChangeAge.bind(Object(f.a)(i)),i.handleChangeGender=i.handleChangeGender.bind(Object(f.a)(i)),i.handleSubmit=i.handleSubmit.bind(Object(f.a)(i)),i.state={userName:"",location:"Canada",age:28,gender:"Male",loginLoading:!1},i}return Object(l.a)(a,[{key:"handleChangeName",value:function(e){this.setState({userName:e.target.value})}},{key:"handleChangeLocation",value:function(e){this.setState({location:e.target.value})}},{key:"handleChangeAge",value:function(e){this.setState({age:e})}},{key:"handleChangeGender",value:function(e){this.setState({gender:e.target.value})}},{key:"componentWillUpdate",value:function(){console.log(this.state)}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),console.log("form submitted");var a=this.state,n=a.userName,i=a.location,s=a.age,o=a.gender;this.setState({loginLoading:!0}),fetch(M+"/api/guest/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:n,location:i,age:s,gender:o})}).then((function(e){return e.json()})).then((function(e){console.log("this is json object",e),e.status?(p("guest_signin",{token:e.token}),t.props.history.push("/chat")):alert("Server Error")}))}},{key:"render",value:function(){return i.a.createElement(v.C,null,i.a.createElement(v.g,{sm:"10",md:"7",lg:"6",xl:"4",className:"mx-auto mt-3"},i.a.createElement("form",{onSubmit:this.handleSubmit},i.a.createElement(v.c,null,i.a.createElement("div",{className:"text-center sign-title"},i.a.createElement("h5",{className:"dark-grey-text mb-5"},i.a.createElement("strong",null,"Sign in"))),i.a.createElement(v.d,{className:"mx-4"},i.a.createElement(v.p,{label:"Your Name",group:!0,type:"text",onChange:this.handleChangeName,validate:!0,error:"wrong",success:"right",required:!0}),i.a.createElement("select",{className:"browser-default custom-select",id:"location",name:"location",value:this.state.location,onChange:this.handleChangeLocation},i.a.createElement("option",null,"Choose your location"),T.map((function(e,t){return i.a.createElement("option",{value:e,key:t},e)}))),i.a.createElement("label",{className:"form-label"},"Your Age"),i.a.createElement(v.q,{id:"age",name:"age",getValue:this.handleChangeAge,min:13,max:99,value:this.state.age,className:"mb-2"}),i.a.createElement("label",{className:"form-label"},"Your Gender"),i.a.createElement("div",{className:"radio-group"},i.a.createElement("div",{className:"radio"},i.a.createElement("input",{id:"radio-1",name:"radio",type:"radio",value:"Male",onChange:this.handleChangeGender,checked:"Male"===this.state.gender}),i.a.createElement("label",{htmlFor:"radio-1",className:"radio-label"},"Male")),i.a.createElement("div",{className:"radio"},i.a.createElement("input",{id:"radio-2",name:"radio",type:"radio",value:"Female",onChange:this.handleChangeGender,checked:"Female"===this.state.gender}),i.a.createElement("label",{htmlFor:"radio-2",className:"radio-label"},"Female"))),i.a.createElement("div",{className:"text-center pt-3 mb-3"},i.a.createElement(v.b,{type:"submit",className:"btn-block z-depth-1a",outline:!0,color:"info"},this.state.logInLoading?"Authenticating...":"Start Chat"))),i.a.createElement(v.t,{className:"mx-5 pt-3 mb-1"})))))}}]),a}(i.a.Component)),P=a(419),F=a(29),D=a(102),_=a.n(D),B=(n.Component,a(414)),R=a.n(B),G=a(256),z=a.n(G),V=a(413),W=a.n(V),H=a(255),K=a.n(H),q=(a(526),a(181)),Y=a(418),J=(a(611),a(39)),Z=a(412),$=a(182),Q=a.n($),X=a(262),ee=a.n(X),te=(a(704),function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).onEditorStateChange=function(e){n.setState({editorState:e})},n.state={showEmojiPicker:!1,toolbar_show:!1,messageText:"",editorState:J.EditorState.createEmpty()},n.onAttachFile=n.onAttachFile.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"onSendClicked",value:function(){this.props.onSendClicked(Q()(Object(J.convertToRaw)(this.state.editorState.getCurrentContent()))),this.setState({editorState:J.EditorState.createEmpty()})}},{key:"onMessageInputChange",value:function(e){this.setState({messageText:e.target.value})}},{key:"onMessageKeyPress",value:function(e){"Enter"===e.key&&this.onSendClicked()}},{key:"toggleEmojiPicker",value:function(){this.setState({showEmojiPicker:!this.state.showEmojiPicker})}},{key:"addEmoji",value:function(e){var t=this.state.editorState,a=Q()(Object(J.convertToRaw)(t.getCurrentContent())),n=a.substring(0,a.length-5),i="".concat(n," :").concat(e.id,": </p>"),s=ee()(i),o=s.contentBlocks,r=s.entityMap,l=J.ContentState.createFromBlockArray(o,r),c=J.EditorState.createWithContent(l);this.setState({editorState:c})}},{key:"closeEmojiPicker",value:function(){this.setState({showEmojiPicker:!1})}},{key:"onEditorChange",value:function(){this.props.onTyping()}},{key:"toggle_toolbar",value:function(){this.setState({toolbar_show:!this.state.toolbar_show})}},{key:"keyBindingFunction",value:function(e){return J.KeyBindingUtil.hasCommandModifier(e)&&e.ctrlKey&&"Enter"===e.key||"Enter"!==e.key?Object(J.getDefaultKeyBinding)(e):void this.onSendClicked()}},{key:"findTargetUser",value:function(){this.props.findTargetUser()}},{key:"onAttachFile",value:function(e){var t=this;e.preventDefault();var a=new FormData;a.append("attachFile",this.attachFile.files[0]),fetch("".concat(M,"/api/attach-file"),{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){if(e.status){var a,n=t.state.editorState,i=Q()(Object(J.convertToRaw)(n.getCurrentContent()));console.log("this is convert html",i),console.log("last index charactor",i.substring(i.length-5)),a=i.substring(0,i.length),console.log("Index and subhtml",a,i.length);var s='<img src="'.concat(M,"/public/uploads/").concat(e.fileName,'" alt="').concat(M,"/public/uploads/").concat(e.fileName,'">'),o="".concat(a).concat(s),r=ee()(o),l=r.contentBlocks,c=r.entityMap,h=J.ContentState.createFromBlockArray(l,c),u=J.EditorState.createWithContent(h);t.setState({editorState:u}),console.log("this is total html",o)}}))}},{key:"image_thumbs",value:function(){console.log("image thumbs start")}},{key:"callWithVideo",value:function(e){var t={audio:!0,video:e};this.props.startCall(!0,this.props.targetUser.id,t)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement(q.Navbar,{left:i.a.createElement("div",null,i.a.createElement(K.a,{mdHidden:!0,lgHidden:!0},i.a.createElement("p",{className:"navBarText"})),i.a.createElement(q.Avatar,{src:"".concat(M,"/public/profile/").concat(this.props.signedInUser.profile_image),alt:"logo",size:"large",type:"circle flexible"}),i.a.createElement("div",{className:"user-info"},i.a.createElement("p",{className:"navBarText user-name"},this.props.signedInUser.userName),i.a.createElement("p",{className:"navBarText user-title"},this.props.signedInUser.gender,"   ",this.props.signedInUser.age," ",this.props.signedInUser.location))),center:i.a.createElement("div",null,i.a.createElement(v.b,{className:"action-btn next-user",color:"primary",onClick:this.findTargetUser.bind(this)},i.a.createElement("img",{alt:"Arrow, person, profile, right, user icon",className:"n3VNCb",src:"https://cdn3.iconfinder.com/data/icons/user-icons-7/100/31-1User-512.png"}))),right:i.a.createElement("div",null,i.a.createElement("div",{className:"navbar-right"},i.a.createElement(v.b,{className:"action-btn phone",color:"primary",onClick:this.callWithVideo.bind(this,!1)},i.a.createElement(v.n,{icon:"phone-alt",className:"mr-1",size:"lg"})),i.a.createElement(v.b,{className:"action-btn video",color:"primary",onClick:this.callWithVideo.bind(this,!0)},i.a.createElement(v.n,{icon:"video",className:"mr-1",size:"lg"})),i.a.createElement(v.j,null,i.a.createElement(v.m,{caret:!0,color:"primary"},i.a.createElement(v.n,{icon:"ellipsis-v",className:"mr-1",size:"lg"})),i.a.createElement(v.l,{basic:!0},i.a.createElement(v.k,{onClick:function(){e.props.onSearchSettingModalShow(!0)}},"Search Setting"),i.a.createElement(v.k,null,"Report"),i.a.createElement(v.k,{onClick:function(){e.props.onProfileModalShow(!0)}},"Your Profile"),i.a.createElement(v.k,{divider:!0}),i.a.createElement(v.k,null,"Log Out")))))}),this.props.targetUser.id?i.a.createElement("div",null,i.a.createElement(q.MessageList,{className:"message-list",lockable:!0,toBottomHeight:"300",dataSource:this.props.targetUser.messages,downButton:!0}),i.a.createElement(W.a,{className:"send-message-form"},i.a.createElement(z.a,{style:{width:"100%",position:"relative"}},i.a.createElement("i",{className:"toggle-emoji far fa-smile toggle-icon",onClick:this.toggleEmojiPicker.bind(this)}),i.a.createElement(v.n,{icon:"palette",size:"lg",onClick:this.toggle_toolbar.bind(this),className:"font-selector mr-1 toggle-icon"}),i.a.createElement(Z.Editor,{editorState:this.state.editorState,wrapperClassName:"demo-wrapper",toolbarClassName:this.state.toolbar_show?"":"toggle-toolbar",editorClassName:"demo-editor",keyBindingFn:this.keyBindingFunction.bind(this),onEditorStateChange:this.onEditorStateChange,onChange:this.onEditorChange.bind(this),toolbar:{options:["inline","image","colorPicker","fontSize","fontFamily","emoji","history"],inline:{inDropdown:!0},image:{uploadEnabled:!0},inputAccept:"image/gif,image/jpeg,image/jpg,image/png,image/svg"},autoFocus:!0}),i.a.createElement("label",{htmlFor:"attachFile",className:"attach-file"},i.a.createElement("i",{className:"fas fa-paperclip toggle-icon "})),i.a.createElement("input",{ref:function(t){e.attachFile=t},onChange:this.onAttachFile.bind(this),type:"file",id:"attachFile",accept:".png, .jpg, .jpeg"}),i.a.createElement(R.a.Button,null,i.a.createElement("div",{disabled:!this.state.messageText,className:"sendButton",onClick:this.onSendClicked.bind(this)},i.a.createElement("svg",{class:"jss4",focusable:"false",viewBox:"0 0 24 24","aria-hidden":"true",role:"presentation"},i.a.createElement("path",{fill:"#fff",d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"}),i.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}))))))):i.a.createElement("div",{className:"waiting-container"},i.a.createElement("div",{className:"title-box"},i.a.createElement("h1",null,"Hello, ",this.props.signedInUser.userName,"!"),i.a.createElement("br",null)),i.a.createElement("div",{className:"body-box"},i.a.createElement("p",null,"Select a friend to start a chat.")))),i.a.createElement(Y.a,{style:this.state.showEmojiPicker?{position:"absolute",bottom:"90px",right:"10px",opacity:"1"}:{position:"absolute",bottom:"90px",right:"10px",opacity:"0",zIndex:"-3"},onSelect:this.addEmoji.bind(this),emojiTooltip:!0}),this.state.showEmojiPicker?i.a.createElement("div",null,i.a.createElement("div",{className:"emoji-back",onClick:this.closeEmojiPicker.bind(this)})):null)}}]),a}(n.Component)),ae=(a(708),function(){return i.a.createElement("div",{className:"message-text message-text-left on-typing"},i.a.createElement("div",{id:"circleG"},i.a.createElement("div",{id:"circleG_1",class:"circleG"}),i.a.createElement("div",{id:"circleG_2",class:"circleG"}),i.a.createElement("div",{id:"circleG_3",class:"circleG"})))}),ne=a(138),ie=a.n(ne),se=(a(711),function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={imageURL:"".concat(M,"/public/profile/").concat(n.props.profileInfo.profile_image)},n.handleUploadImage=n.handleUploadImage.bind(Object(f.a)(n)),n.handleChangeProfile=n.handleChangeProfile.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"componentWillReceiveProps",value:function(){this.setState({imageURL:"".concat(M,"/public/profile/").concat(this.props.profileInfo.profile_image)})}},{key:"handleUploadImage",value:function(e){var t=this;e.preventDefault();var a=new FormData;a.append("file",this.uploadInput.files[0]),a.append("fileName",this.fileName.value),console.log("upload file name",this.fileName.value),fetch("".concat(M,"/api/profile"),{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){if(console.log("this is json object",e),e.status){p("guest_signin",{token:e.token});var a=ie()(e.token).user;t.props.onChangeProfile(a)}else alert("Server Error")}))}},{key:"handleChangeProfile",value:function(){console.log("bind this")}},{key:"onProfileModalShow",value:function(){this.props.onProfileModalShow(!1)}},{key:"handleChangeLocation",value:function(){}},{key:"handleChangeGender",value:function(){}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(v.C,Object(F.a)({className:"mt-5"},"className",this.props.profileContainer),i.a.createElement(v.g,null,i.a.createElement(v.f,{onClick:this.onProfileModalShow.bind(this)}),i.a.createElement(v.r,{className:"text-center"},i.a.createElement(v.d,null,i.a.createElement("form",{onSubmit:this.handleChangeProfile},i.a.createElement("div",{className:"profile-image"},i.a.createElement("img",{src:"".concat(M,"/public/profile/").concat(this.props.profileInfo.profile_image),className:"img-fluid"}),i.a.createElement("div",{className:"upload-button"},i.a.createElement("label",{htmlFor:"imageUpload"}),i.a.createElement("input",{ref:function(t){e.uploadInput=t},onChange:this.handleUploadImage.bind(this),type:"file",id:"imageUpload",accept:".png, .jpg, .jpeg"}),i.a.createElement("input",{ref:function(t){e.fileName=t},value:this.props.profileInfo.profile_image,type:"hidden"})),i.a.createElement("h4",{className:"userName"},this.props.profileInfo.userName),i.a.createElement("h6",{className:"userInfo"},"".concat(this.props.profileInfo.gender,"  ").concat(this.props.profileInfo.age,"  ").concat(this.props.profileInfo.location)),i.a.createElement("hr",null)),i.a.createElement("div",null,i.a.createElement(v.p,{label:"Your Name",ref:function(t){e.userName=t},group:!0,type:"text",onChange:this.handleChangeName,validate:!0,error:"wrong",success:"right",value:this.props.profileInfo.userName,required:!0}),i.a.createElement("label",{className:"form-label"},"Your Location"),i.a.createElement("select",{className:"browser-default custom-select",id:"location",name:"location",value:this.props.profileInfo.location,onChange:this.handleChangeLocation.bind(this)},i.a.createElement("option",null,"Choose your location"),T.map((function(e,t){return i.a.createElement("option",{value:e,key:t},e)}))),i.a.createElement("label",{className:"form-label"},"Your Age"),i.a.createElement(v.q,{id:"age",name:"age",getValue:this.handleChangeAge,min:13,max:99,value:this.props.profileInfo.age,className:"mb-2"}),i.a.createElement("label",{className:"form-label"},"Your Gender"),i.a.createElement("div",{className:"radio-group"},i.a.createElement("div",{className:"radio"},i.a.createElement("input",{id:"radio-1",name:"radio",type:"radio",value:"Male",onChange:this.handleChangeGender.bind(this),checked:"Male"===this.state.gender}),i.a.createElement("label",{htmlFor:"radio-1",className:"radio-label"},"Male")),i.a.createElement("div",{className:"radio"},i.a.createElement("input",{id:"radio-2",name:"radio",type:"radio",value:"Female",onChange:this.handleChangeGender.bind(this),checked:"Female"===this.state.gender}),i.a.createElement("label",{htmlFor:"radio-2",className:"radio-label"},"Female"))),i.a.createElement("div",{className:"text-center pt-3 mb-3"},i.a.createElement(v.b,{type:"submit",color:"primary",size:"sm"},"Apply"),i.a.createElement(v.b,{color:"cyan",size:"sm",onClick:this.onProfileModalShow.bind(this)},"Close")))))))))}}]),a}(n.Component)),oe=(a(348),a(712),function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e){var n;Object(r.a)(this,a);var i=(n=t.call(this,e)).props.imageUrl.split("public/")[1];return n.state={downloadPath:i},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){console.log("this is fullscreen image's path",this.state)}},{key:"onShowImageFullScreen",value:function(){this.props.onShowImageFullScreen()}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{className:"full-image"},i.a.createElement("span",{onClick:this.onShowImageFullScreen.bind(this),className:"close-btn"},"X"),i.a.createElement("a",{href:this.state.downloadPath,download:"image-file",className:"download-btn"},i.a.createElement("i",{class:"fa fa-download"})),i.a.createElement("img",{src:this.props.imageUrl,alt:""})))}}]),a}(n.Component)),re=a(264),le=(a(258),a(767),(0,re.a.createSliderWithTooltip)(re.a.Range)),ce=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e){var n;Object(r.a)(this,a);var i=(n=t.call(this,e)).props.searchSetting;return n.state={searchSetting:i},n.handleChangeGender=n.handleChangeGender.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"handleChangeSearchSetting",value:function(e){e.preventDefault()}},{key:"handleChangeGender",value:function(e){var t=this.state.searchSetting;t.gender=e.target.value,this.setState({searchSetting:t})}},{key:"handleChangeLocation",value:function(e){console.log(e.target.value);var t=this.state.searchSetting;t.location=e.target.value,this.setState({searchSetting:t})}},{key:"handleChangeAge",value:function(e){var t=this.state.searchSetting;t.ageMin=e[0],t.ageMax=e[1],this.setState({searchSetting:t})}},{key:"onSearchSettingModalShow",value:function(){this.props.onSearchSettingModalShow(!1)}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(v.C,Object(F.a)({className:"mt-5"},"className",this.props.searchContainer),i.a.createElement(v.g,null,i.a.createElement(v.f,{onClick:this.onSearchSettingModalShow.bind(this)}),i.a.createElement(v.r,{className:"text-center"},i.a.createElement(v.e,{className:"card-title h4 pb-2"},i.a.createElement("strong",null," Search Filter Setting ")," ")," ",i.a.createElement(v.d,null,i.a.createElement("form",{onSubmit:this.handleChangeSearchSetting.bind(this)},i.a.createElement("div",null,i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{className:"form-label"}," Location ")," ",i.a.createElement("select",{className:"browser-default custom-select",id:"location1",name:"location1",value:this.props.searchSetting.location,onChange:this.handleChangeLocation.bind(this)},i.a.createElement("option",{value:""}," All ")," ",T.map((function(e,t){return i.a.createElement("option",{value:e,key:t}," ",e," ")}))," ")," "),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{className:"form-label"}," Age Range "),"                                         ",i.a.createElement(le,{min:13,max:99,defaultValue:[this.props.searchSetting.ageMin,this.props.searchSetting.ageMax],tipFormatter:function(e){return"".concat(e)},onChange:this.handleChangeAge.bind(this)})," "),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{className:"form-label"}," Gender ")," ",i.a.createElement("div",{className:"radio-group"},i.a.createElement("div",{className:"radio"},i.a.createElement("input",{id:"radio1",name:"radio1",type:"radio",value:"",onChange:this.handleChangeGender.bind(this),checked:""===this.state.searchSetting.gender})," ",i.a.createElement("label",{htmlFor:"radio1",className:"radio-label"}," All ")," "),i.a.createElement("div",{className:"radio"},i.a.createElement("input",{id:"radio2",name:"radio1",type:"radio",value:"Male",onChange:this.handleChangeGender.bind(this),checked:"Male"===this.state.searchSetting.gender})," ",i.a.createElement("label",{htmlFor:"radio2",className:"radio-label"}," Male ")," "),i.a.createElement("div",{className:"radio"},i.a.createElement("input",{id:"radio3",name:"radio1",type:"radio",value:"Female",onChange:this.handleChangeGender.bind(this),checked:"Female"===this.state.searchSetting.gender})," ",i.a.createElement("label",{htmlFor:"radio3",className:"radio-label"}," Female ")," ")," ")," "),i.a.createElement("div",{className:"text-center pt-3 mb-3"}," ",i.a.createElement(v.b,{color:"cyan",size:"sm",onClick:this.onSearchSettingModalShow.bind(this)},"Close ")," "))," "))," ")," ")," ")," ")}}]),a}(n.Component),he=a(180),ue=a.n(he),de=a(77),me=a.n(de),ge=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={},e}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement(me.a,{show:this.props.show},i.a.createElement(me.a.Header,null,i.a.createElement(me.a.Title,null,"Error")),i.a.createElement(me.a.Body,null,i.a.createElement("h1",{className:"text-center"},i.a.createElement(ue.a,{glyph:"alert"})),i.a.createElement("h5",{className:"text-center"},this.props.errorMessage)))}}]),a}(n.Component),pe=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={},e}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement(me.a,{show:this.props.show},i.a.createElement(me.a.Body,null,i.a.createElement("h1",{className:"text-center"},i.a.createElement(ue.a,{glyph:"refresh"})),i.a.createElement("h5",{className:"text-center"},"Loading...")))}}]),a}(n.Component),fe=(a(793),a(257)),ve=a.n(fe),be=a(116),Ee=a.n(be),Se=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_SERVER_URI;Ee.a.defaults.baseURL=Se;var ye=a(184),ke=(a(851),a(263)),Ce=a.n(ke),we=(a(879),a(101)),je=a.n(we),Oe=ve.a.connect("".concat(M)),Ne=function(){function e(){Object(r.a)(this,e),this.events={}}return Object(l.a)(e,[{key:"emit",value:function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return this.events[e]&&this.events[e].forEach((function(e){return e.apply(void 0,a)})),this}},{key:"on",value:function(e,t){return this.events[e]?this.events[e].push(t):this.events[e]=[t],this}},{key:"off",value:function(e,t){if(e&&je.a.isFunction(t)){var a=this.events[e],n=a.findIndex((function(e){return e===t}));a.splice(n,1)}else this.events[e]=[];return this}}]),e}(),Ie=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"start",value:function(){var e=this;return navigator.mediaDevices.getUserMedia({video:{facingMode:"user",height:{min:360,ideal:720,max:1080}},audio:!0}).then((function(t){e.stream=t,e.emit("stream",t)})).catch((function(e){e instanceof DOMException?alert("Cannot open webcam and/or microphone"):console.log(e)})),this}},{key:"toggle",value:function(e,t){var a=arguments.length;return this.stream&&this.stream["get".concat(e,"Tracks")]().forEach((function(e){var n=2===a?t:!e.enabled;je.a.set(e,"enabled",n)})),this}},{key:"stop",value:function(){return this.stream&&this.stream.getTracks().forEach((function(e){return e.stop()})),this}}]),a}(Ne),Me={iceServers:[{url:"turn:numb.viagenie.ca",credential:"nothingbutthebest",username:"bluesky410219@gmail.com"}]},Ue=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this)).pc=new RTCPeerConnection(Me),n.pc.onicecandidate=function(e){return Oe.emit("call",{to:n.friendID,candidate:e.candidate})},n.pc.ontrack=function(e){return n.emit("peerStream",e.streams[0])},n.mediaDevice=new Ie,n.friendID=e,n}return Object(l.a)(a,[{key:"start",value:function(e,t){var a=this;return this.mediaDevice.on("stream",(function(t){t.getTracks().forEach((function(e){a.pc.addTrack(e,t)})),a.emit("localStream",t),e?Oe.emit("request",{to:a.friendID}):a.createOffer()})).start(t),this}},{key:"stop",value:function(e){return e&&Oe.emit("end",{to:this.friendID}),this.mediaDevice.stop(),this.pc.close(),this.pc=null,this.off(),this}},{key:"createOffer",value:function(){return this.pc.createOffer().then(this.getDescription.bind(this)).catch((function(e){return console.log(e)})),this}},{key:"createAnswer",value:function(){return this.pc.createAnswer().then(this.getDescription.bind(this)).catch((function(e){return console.log(e)})),this}},{key:"getDescription",value:function(e){return this.pc.setLocalDescription(e),Oe.emit("call",{to:this.friendID,sdp:e}),this}},{key:"setRemoteDescription",value:function(e){var t=new RTCSessionDescription(e);return this.pc.setRemoteDescription(t),this}},{key:"addIceCandidate",value:function(e){if(e){var t=new RTCIceCandidate(e);this.pc.addIceCandidate(t)}return this}}]),a}(Ne),xe=a(265),Le=a(2),Te=a.n(Le),Ae=(a(880),function(e,t){return Te()("btn-action fa ".concat(e),{disable:!t})});var Pe=function(e){var t=e.peerSrc,a=e.localSrc,s=e.config,o=e.mediaDevice,r=e.status,l=e.endCall,c=Object(n.useRef)(null),h=Object(n.useRef)(null),u=Object(n.useState)(s.video),d=Object(xe.a)(u,2),m=d[0],g=d[1],p=Object(n.useState)(s.audio),f=Object(xe.a)(p,2),v=f[0],b=f[1];Object(n.useEffect)((function(){c.current&&t&&(c.current.srcObject=t),h.current&&a&&(h.current.srcObject=a)})),Object(n.useEffect)((function(){o&&(o.toggle("Video",m),o.toggle("Audio",v))}));var E=function(e){"video"===e&&(g(!m),o.toggle("Video")),"audio"===e&&(b(!v),o.toggle("Audio"))};return i.a.createElement("div",{className:Te()("call-window",r)},i.a.createElement("div",{className:"video-contact"},i.a.createElement("video",{id:"peerVideo",ref:c,autoPlay:!0})),i.a.createElement("div",{className:"video-user"},i.a.createElement("video",{id:"localVideo",ref:h,autoPlay:!0,muted:!0})),i.a.createElement("div",{className:"video-control"},i.a.createElement("button",{key:"btnVideo",type:"button",className:Ae("fa-video-camera",m),onClick:function(){return E("video")}}),i.a.createElement("button",{key:"btnAudio",type:"button",className:Ae("fa-microphone",v),onClick:function(){return E("audio")}}),i.a.createElement("button",{type:"button",className:"btn-action hangup fa fa-phone",onClick:function(){return l(!0)}})))};a(881);var Fe=function(e){var t=e.status,a=e.callFrom,n=e.startCall,s=e.rejectCall,o=function(e){var t={audio:!0,video:e};return function(){return n(!1,a,t)}};return i.a.createElement("div",{className:Te()("call-modal",t)},i.a.createElement("p",null,i.a.createElement("span",{className:"caller"},"".concat(a," is calling"))),i.a.createElement("button",{type:"button",className:"btn-action fa fa-video-camera",onClick:o(!0)}),i.a.createElement("button",{type:"button",className:"btn-action fa fa-phone",onClick:o(!1)}),i.a.createElement("button",{type:"button",className:"btn-action hangup fa fa-phone",onClick:s}))},De=g("guest_signin");if(De&&De.token)ie()(De.token).user;var _e=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(){var e,n;Object(r.a)(this,a),(n=t.call(this)).socket=null;var i=g("guest_signin");if(i&&i.token)var s=ie()(i.token).user;return n.state=(e={signInModalShow:!1,users:[],userChatData:"",user:null,selectedUserIndex:1},Object(F.a)(e,"signInModalShow",!1),Object(F.a)(e,"profileModalShow",!1),Object(F.a)(e,"searchModalShow",!1),Object(F.a)(e,"error",!1),Object(F.a)(e,"errorMessage",""),Object(F.a)(e,"targetUser",""),Object(F.a)(e,"blackUsersList",[s._id]),Object(F.a)(e,"signedInUser",s),Object(F.a)(e,"searchSetting",{location:"",gender:"",ageMin:13,ageMax:99}),Object(F.a)(e,"onTyping",!1),Object(F.a)(e,"showImageFullScreen",!1),Object(F.a)(e,"callWindow",""),Object(F.a)(e,"callModal",""),Object(F.a)(e,"callFrom",""),Object(F.a)(e,"localSrc",null),Object(F.a)(e,"peerSrc",null),e),n.pc={},n.config=null,n.startCallHandler=n.startCall.bind(Object(f.a)(n)),n.endCallHandler=n.endCall.bind(Object(f.a)(n)),n.rejectCallHandler=n.rejectCall.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.initAxios(),this.initSocketConnection(),this.createSocketRoom(),this.setupSocketListeners(),console.log("This is signed in user:",this.state.signedInUser)}},{key:"componentDidUpdate",value:function(){for(var e=document.getElementsByTagName("img"),t=this,a=0;a<e.length;a++)e[a].addEventListener("click",(function(){this.hasAttribute("data_group")&&(console.log("this is attach file property",this.attributes.getNamedItem("src").value),t.setState({showImageFullScreen:!0,attachFileUrl:this.attributes.getNamedItem("src").value}))}))}},{key:"initSocketConnection",value:function(){this.socket=Oe}},{key:"initAxios",value:function(){var e=this;Ee.a.interceptors.request.use((function(t){return e.setState({loading:!0}),t}),(function(t){return e.setState({loading:!1}),e.setState({errorMessage:"Couldn't connect to server. try refreshing the page.",error:!0}),Promise.reject(t)})),Ee.a.interceptors.response.use((function(t){return e.setState({loading:!1}),t}),(function(t){return e.setState({loading:!1}),e.setState({errorMessage:"Some error occured. try after sometime",error:!0}),Promise.reject(t)}))}},{key:"onClientDisconnected",value:function(){ye.NotificationManager.error("Connection Lost from server please check your connection.","Error!")}},{key:"onReconnection",value:function(){this.state.user&&(this.socket.emit("sign-in",this.state.user),ye.NotificationManager.success("Connection Established.","Reconnected!"))}},{key:"createSocketRoom",value:function(){this.socket.emit("create_room",this.state.signedInUser)}},{key:"findTargetUser",value:function(){if(this.state.targetUser){var e=this.state.blackUsersList;e.push(this.state.targetUser._id),this.setState({blackUsersList:e})}var t={blackUsersList:this.state.blackUsersList,searchSetting:this.state.searchSetting,signedInUser:this.state.signedInUser,prevTargetUser:this.state.targetUser};this.socket.emit("find_target",t)}},{key:"onFindTargetUser",value:function(e){console.log("this is target user",e);var t={id:e._id,name:e.userName,profile_image:e.profile_image,gender:e.gender,location:e.location,age:e.age};this.setState({targetUser:e}),this.setState({userChatData:t})}},{key:"onIgnore",value:function(){this.setState({targetUser:""}),this.setState({userChatData:{}})}},{key:"setupSocketListeners",value:function(){var e=this;this.socket.on("message",this.onMessageRecieved.bind(this)),this.socket.on("reconnect",this.onReconnection.bind(this)),this.socket.on("disconnect",this.onClientDisconnected.bind(this)),this.socket.on("find_target",this.onFindTargetUser.bind(this)),this.socket.on("ignore",this.onIgnore.bind(this)),this.socket.on("on-typing",this.onTargetUserTyping.bind(this)),this.socket.on("request",(function(t){var a=t.from;e.setState({callModal:"active",callFrom:a})})).on("call",(function(t){t.sdp?(e.pc.setRemoteDescription(t.sdp),"offer"===t.sdp.type&&e.pc.createAnswer()):e.pc.addIceCandidate(t.candidate)})).on("end",this.endCall.bind(this,!1)).emit("init")}},{key:"customeRenderAddCamp",value:function(){}},{key:"onMessageRecieved",value:function(e){var t=this.state.userChatData,a=e.message,n=a.text;if("<p></p>\n"==n)return!1;for(var i=a.text,s=Object(P.a)(i.matchAll(/:[\w]+[_]?[-]?[+]*[\w]+:/g)),o=0;o<s.length;o++){var r=document.querySelector("[title="+String(s[o]).split(":").join("")+"]").innerHTML;n=n.replace(String(s[o]),String(r))}n=n.split("<img").join("<img data_group='attach-file'"),e.from===this.state.signedInUser._id?(a.position="right",a.renderAddCmp=function(){return Ce()('<div className="message-text message-text-right">'.concat(n,"</div>"))},e.to,a.avatar="".concat(M,"/public/profile/").concat(this.state.signedInUser.profile_image)):(a.position="left",a.renderAddCmp=function(){return Ce()('<div className="message-text message-text-left">'.concat(n,"</div>"))},e.from,a.avatar="".concat(M,"/public/profile/").concat(this.state.targetUser.profile_image)),a.alert=!1,t.messages?1==t.messages[t.messages.length-1].alert&&t.messages.pop():t.messages=[];var l=this.state.userChatData.messages;if("undefined"!=typeof l&&l.length>0&&l[l.length-1].position==a.position){var c=l[l.length-1];c.avatar="",c.date="",t.messages.pop(),t.messages.push(c)}t.messages.push(a),this.setState({userChatData:t}),console.log("This is state for this component",this.state);var h=document.querySelector('[class="rce-mlist"]');h.scrollTop=h.scrollHeight}},{key:"onUserClicked",value:function(e){var t=e.user;this.socket.emit("sign-in",t);var a=this.state.users.filter((function(e){return e.id!==t.id}));this.setState({user:t,signInModalShow:!1,userChatData:a})}},{key:"onChatClicked",value:function(e){for(var t=this.state.userChatData,a=0;a<t.length;a++)if(t[a].id===e.user.id)return t[a].unread=0,void this.setState({selectedUserIndex:a,userChatData:t})}},{key:"createMessage",value:function(e){var t={to:this.state.targetUser._id,message:{type:"text",text:e,date:+new Date,className:"message"},from:this.state.signedInUser._id};this.socket.emit("message",t)}},{key:"changeProfile",value:function(e){this.setState({signedInUser:e})}},{key:"onProfileModalShow",value:function(e){this.setState({profileModalShow:e})}},{key:"onSearchSettingModalShow",value:function(e){this.setState({searchModalShow:e})}},{key:"onShowImageFullScreen",value:function(){this.setState({showImageFullScreen:!1})}},{key:"onTyping",value:function(){this.socket.emit("on-typing",this.state.targetUser)}},{key:"onTargetUserTyping",value:function(){var e=this;this.setState({onTyping:!0});var t=this.state.userChatData,a=t.messages,n={};this.state.targetUser._id;"undefined"!=typeof a&&(1!=a[a.length-1].alert||0==a.length?(n.position="left",n.renderAddCmp=function(){return i.a.createElement(ae,null)},n.avatar="".concat(M,"/public/profile/").concat(this.state.targetUser.profile_image),n.className="message",n.alert=!0,t.messages||(t.messages=[]),t.messages.push(n),this.setState({userChatData:t}),this.turnOffRedTimeout=setTimeout((function(){1==(t=e.state.userChatData).messages[t.messages.length-1].alert&&(t.messages.pop(),e.setState({userChatData:t}))}),2e3)):console.log("@@@@@@@***********"))}},{key:"startCall",value:function(e,t,a){var n=this;console.log("call start now ",e,t,a),this.config=a,this.pc=new Ue(t).on("localStream",(function(t){var a={callWindow:"active",localSrc:t};e||(a.callModal=""),n.setState(a)})).on("peerStream",(function(e){return n.setState({peerSrc:e})})).start(e,a)}},{key:"rejectCall",value:function(){var e=this.state.callFrom;this.socket.emit("end",{to:e}),this.setState({callModal:""})}},{key:"endCall",value:function(e){je.a.isFunction(this.pc.stop)&&this.pc.stop(e),this.pc={},this.config=null,this.setState({callWindow:"",callModal:"",localSrc:null,peerSrc:null})}},{key:"render",value:function(){var e=this.state,t=(e.clientId,e.callFrom,e.callModal),a=e.callWindow,n=e.localSrc,s=e.peerSrc;return i.a.createElement("div",null,i.a.createElement(te,{signedInUser:this.state.signedInUser,onSendClicked:this.createMessage.bind(this),targetUser:this.state.userChatData,onProfileModalShow:this.onProfileModalShow.bind(this),onSearchSettingModalShow:this.onSearchSettingModalShow.bind(this),findTargetUser:this.findTargetUser.bind(this),onTyping:this.onTyping.bind(this),startCall:this.startCallHandler}),i.a.createElement(ge,{show:this.state.error,errorMessage:this.state.errorMessage}),i.a.createElement(pe,{show:this.state.loading}),i.a.createElement(ye.NotificationContainer,null),i.a.createElement(se,{profileInfo:this.state.signedInUser,onChangeProfile:this.changeProfile.bind(this),onProfileModalShow:this.onProfileModalShow.bind(this),profileContainer:this.state.profileModalShow?"profile-container":"profile-container-hide"}),i.a.createElement(ce,{searchContainer:this.state.searchModalShow?"search-container":"search-container-hide",searchSetting:this.state.searchSetting,onSearchSettingModalShow:this.onSearchSettingModalShow.bind(this)}),this.state.showImageFullScreen?i.a.createElement(oe,{imageUrl:this.state.attachFileUrl,onShowImageFullScreen:this.onShowImageFullScreen.bind(this)}):null,!je.a.isEmpty(this.config)&&i.a.createElement(Pe,{status:a,localSrc:n,peerSrc:s,config:this.config,mediaDevice:this.pc.mediaDevice,endCall:this.endCallHandler}),i.a.createElement(Fe,{status:t,startCall:this.startCallHandler,rejectCall:this.rejectCallHandler,callFrom:this.state.targetUser._id}))}}]),a}(n.Component),Be=function(){var e=g("guest_signin");return!(!e||!e.token)},Re=function(e){var t=e.component,a=Object(d.a)(e,["component"]);return i.a.createElement(m.b,Object.assign({},a,{render:function(e){return Be()?i.a.createElement(m.a,{to:"/chat"}):i.a.createElement(t,e)}}))},Ge=function(e){var t=e.component,a=Object(d.a)(e,["component"]);return i.a.createElement(m.b,Object.assign({},a,{render:function(e){return Be()?i.a.createElement(t,e):i.a.createElement(m.a,{to:"/"})}}))},ze=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement(m.d,null,i.a.createElement(Re,{exact:!0,path:"/",component:b}),i.a.createElement(Re,{path:"/usersign",component:L}),i.a.createElement(Re,{path:"/guest",component:A}),i.a.createElement(Ge,{path:"/chat",component:_e}))}}]),a}(i.a.Component),Ve=function(e){Object(c.a)(a,e);var t=Object(h.a)(a);function a(e){return Object(r.a)(this,a),t.call(this,e)}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement(u.a,null,i.a.createElement(ze,null))}}]),a}(n.Component),We=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function He(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(i.a.createElement(Ve,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");We?function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):He(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):He(e)}))}}()}},[[420,1,2]]]);
//# sourceMappingURL=main.2b00b180.chunk.js.map